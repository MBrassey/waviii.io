{"ast":null,"code":"import _regeneratorRuntime from\"/home/luc1d/Code/Github/waviii.io/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/luc1d/Code/Github/waviii.io/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/home/luc1d/Code/Github/waviii.io/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/luc1d/Code/Github/waviii.io/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/luc1d/Code/Github/waviii.io/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/luc1d/Code/Github/waviii.io/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import Web3 from\"web3\";import Token from\"./abis/waviii2.json\";import EthSwap from\"./abis/WavSwap.json\";import BuySell from\"./BuySell\";import{WaveTopBottomLoading}from\"react-loadingg\";import FadeIn from\"react-fade-in\";import tokenLogo from\"../assets/img/token-logo.png\";import ethLogo from\"../assets/img/eth-logo.png\";import swapLogo from\"../assets/img/swap_logo.gif\";import CountUp from\"react-countup\";import{Card,CardHeader,CardBody,Row,Col}from\"reactstrap\";var Swap=/*#__PURE__*/function(_Component){_inherits(Swap,_Component);var _super=_createSuper(Swap);_createClass(Swap,[{key:\"componentWillMount\",value:function(){var _componentWillMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return this.loadWeb3();case 2:_context.next=4;return this.loadBlockchainData();case 4:case\"end\":return _context.stop();}}},_callee,this);}));function componentWillMount(){return _componentWillMount.apply(this,arguments);}return componentWillMount;}()},{key:\"loadBlockchainData\",value:function(){var _loadBlockchainData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var web3,accounts,ethBalance,networkId,tokenData,token,tokenBalance,ethSwapData,ethSwap;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!this.state.loading){_context2.next=4;break;}return _context2.abrupt(\"return\",false);case 4:web3=window.web3;_context2.next=7;return web3.eth.getAccounts();case 7:accounts=_context2.sent;this.setState({account:accounts[0]});_context2.next=11;return web3.eth.getBalance(this.state.account);case 11:ethBalance=_context2.sent;this.setState({ethBalance});// Load Token\n_context2.next=15;return web3.eth.net.getId();case 15:networkId=_context2.sent;tokenData=Token.networks[networkId];if(!tokenData){_context2.next=26;break;}token=new web3.eth.Contract(Token.abi,tokenData.address);this.setState({token});_context2.next=22;return token.methods.balanceOf(this.state.account).call();case 22:tokenBalance=_context2.sent;this.setState({tokenBalance:tokenBalance.toString()});_context2.next=28;break;case 26:window.alert(\"Token contract not deployed to detected network.\");this.setState({loading:true});case 28:// Load EthSwap\nethSwapData=EthSwap.networks[networkId];if(ethSwapData){ethSwap=new web3.eth.Contract(EthSwap.abi,ethSwapData.address);this.setState({ethSwap});}else{window.alert(\"EthSwap contract not deployed to detected network.\");this.setState({loading:true});}this.setState({loading:false});case 31:case\"end\":return _context2.stop();}}},_callee2,this);}));function loadBlockchainData(){return _loadBlockchainData.apply(this,arguments);}return loadBlockchainData;}()},{key:\"loadWeb3\",value:function(){var _loadWeb=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(!window.ethereum){_context3.next=6;break;}window.web3=new Web3(window.ethereum);_context3.next=4;return window.ethereum.enable();case 4:_context3.next=7;break;case 6:if(window.web3){window.web3=new Web3(window.web3.currentProvider);}else{// window.alert('Non-Ethereum browser detected. You should consider trying MetaMask!')\nthis.setState({loading:true});this.setState({noEth:true});}case 7:case\"end\":return _context3.stop();}}},_callee3,this);}));function loadWeb3(){return _loadWeb.apply(this,arguments);}return loadWeb3;}()}]);function Swap(props){var _this;_classCallCheck(this,Swap);_this=_super.call(this,props);_this.buyTokens=function(etherAmount){_this.state.ethSwap.methods.buyTokens().send({value:etherAmount,from:_this.state.account}).on(\"transactionHash\",function(hash){_this.setState({loading:true});}).on(\"confirmation\",function(reciept){_this.setState({loading:false});window.location.reload();});};_this.sellTokens=function(tokenAmount){_this.state.token.methods.approve(_this.state.ethSwap.address,tokenAmount).send({from:_this.state.account}).on(\"transactionHash\",function(hash){_this.state.ethSwap.methods.sellTokens(tokenAmount).send({from:_this.state.account}).on(\"transactionHash\",function(hash){_this.setState({loading:true});}).on(\"confirmation\",function(reciept){_this.setState({loading:false});window.location.reload();});});};_this.state={account:\"\",token:{},ethSwap:{},ethBalance:\"0\",tokenBalance:\"0\",loading:undefined};return _this;}_createClass(Swap,[{key:\"render\",value:function render(){var _this2=this;var content;if(this.state.loading){if(this.state.noEth){content=/*#__PURE__*/React.createElement(FadeIn,null,/*#__PURE__*/React.createElement(FadeIn,null,/*#__PURE__*/React.createElement(CardBody,{className:\"waviii-2\"},/*#__PURE__*/React.createElement(FadeIn,null,/*#__PURE__*/React.createElement(\"div\",{id:\"content\",className:\"mt-3\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex justify-content-between mb-3\"},/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-light waviii\",disabled:true,onClick:function onClick(event){_this2.setState({currentForm:\"buy\"});}},\"Buy\"),/*#__PURE__*/React.createElement(\"img\",{src:swapLogo,className:\"swapLogo\",alt:\"waviii Swap Logo\"}),/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-light waviii\",disabled:true,onClick:function onClick(event){_this2.setState({currentForm:\"sell\"});}},\"Sell\")),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"div\",{className:\"card mb-4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"card-body\"},/*#__PURE__*/React.createElement(FadeIn,null,/*#__PURE__*/React.createElement(\"form\",{className:\"mb-3\",onSubmit:function onSubmit(event){event.preventDefault();var etherAmount;etherAmount=_this2.input.value.toString();etherAmount=window.web3.utils.toWei(etherAmount,\"Ether\");_this2.props.buyTokens(etherAmount);}},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"label\",{className:\"float-left\"},/*#__PURE__*/React.createElement(\"b\",null,\"Input\")),/*#__PURE__*/React.createElement(\"span\",{className:\"float-right text-muted\"},\"Balance:\",\" \",/*#__PURE__*/React.createElement(CountUp,{duration:2.7,start:-10,separator:\"\",decimals:2,decimal:\".\",end:0}))),/*#__PURE__*/React.createElement(\"div\",{className:\"input-group mb-4\"},/*#__PURE__*/React.createElement(\"input\",{type:\"text\",onChange:function onChange(event){var etherAmount=_this2.input.value.toString();_this2.setState({output:etherAmount*100});},ref:function ref(input){_this2.input=input;},className:\"form-control form-control-lg\",placeholder:\"0\",disabled:true}),/*#__PURE__*/React.createElement(\"div\",{className:\"input-group-append\"},/*#__PURE__*/React.createElement(\"div\",{className:\"input-group-text\"},/*#__PURE__*/React.createElement(\"strong\",null,\"\\xA0\\xA0\"),/*#__PURE__*/React.createElement(\"img\",{src:ethLogo,height:\"29\",alt:\"\"}),/*#__PURE__*/React.createElement(\"strong\",null,\"\\xA0\\xA0 ETH \\xA0\")))),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"label\",{className:\"float-left\"},/*#__PURE__*/React.createElement(\"b\",null,\"Output\")),/*#__PURE__*/React.createElement(\"span\",{className:\"float-right text-muted\"},\"Balance:\",\" \",/*#__PURE__*/React.createElement(CountUp,{duration:2.7,start:-10,separator:\"\",decimals:2,decimal:\".\",end:0}))),/*#__PURE__*/React.createElement(\"div\",{className:\"input-group mb-2\"},/*#__PURE__*/React.createElement(\"input\",{type:\"text\",className:\"form-control form-control-lg\",placeholder:\"0\",value:this.state.output,disabled:true}),/*#__PURE__*/React.createElement(\"div\",{className:\"input-group-append\"},/*#__PURE__*/React.createElement(\"div\",{className:\"input-group-text waviii\"},/*#__PURE__*/React.createElement(\"strong\",null,\"\\xA0\\xA0\"),/*#__PURE__*/React.createElement(\"img\",{src:tokenLogo,height:\"29\",alt:\"\"}),/*#__PURE__*/React.createElement(\"strong\",null,\"\\xA0 waviii\")))),/*#__PURE__*/React.createElement(\"div\",{className:\"mb-5\"},/*#__PURE__*/React.createElement(\"span\",{className:\"float-left text-muted\"},\"Exchange Rate\"),/*#__PURE__*/React.createElement(\"span\",{className:\"float-right text-muted waviii responsive3\"},\"1 ETH = 100 waviii\")),/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",disabled:true,className:\"btn btn-primary btn-block btn-lg waviii\"},\"locked\"))))),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(FadeIn,null,/*#__PURE__*/React.createElement(\"a\",{href:\"https://metamask.io/download.html\",className:\"noEth\"},/*#__PURE__*/React.createElement(\"center\",null,\"Blockchain browser not detected! Install MetaMask to use waviii.\"))))))));}else{content=/*#__PURE__*/React.createElement(\"p\",{id:\"loader\",className:\"text-center\"},/*#__PURE__*/React.createElement(WaveTopBottomLoading,{color:\"#2c91c7\"}));}}else{content=/*#__PURE__*/React.createElement(BuySell,{ethBalance:this.state.ethBalance,tokenBalance:this.state.tokenBalance,buyTokens:this.buyTokens,sellTokens:this.sellTokens});}return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"content\"},/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{md:\"12\"},/*#__PURE__*/React.createElement(Card,null,/*#__PURE__*/React.createElement(FadeIn,null,/*#__PURE__*/React.createElement(CardHeader,{className:\"responsive2\"},/*#__PURE__*/React.createElement(\"a\",{className:\"waviii3 responsive2\",href:\"https://etherscan.io/address/\".concat(this.state.account),target:\"_blank\",rel:\"noopener noreferrer\"},/*#__PURE__*/React.createElement(\"span\",null,this.state.account)))),/*#__PURE__*/React.createElement(CardBody,{className:\"all-icons\"},/*#__PURE__*/React.createElement(\"div\",{className:\"content mr-auto ml-auto\",style:{width:\"90%\"}},content)))))));}}]);return Swap;}(Component);export default Swap;","map":{"version":3,"sources":["/home/luc1d/Code/Github/waviii.io/src/views/swap.js"],"names":["React","Component","Web3","Token","EthSwap","BuySell","WaveTopBottomLoading","FadeIn","tokenLogo","ethLogo","swapLogo","CountUp","Card","CardHeader","CardBody","Row","Col","Swap","loadWeb3","loadBlockchainData","state","loading","web3","window","eth","getAccounts","accounts","setState","account","getBalance","ethBalance","net","getId","networkId","tokenData","networks","token","Contract","abi","address","methods","balanceOf","call","tokenBalance","toString","alert","ethSwapData","ethSwap","ethereum","enable","currentProvider","noEth","props","buyTokens","etherAmount","send","value","from","on","hash","reciept","location","reload","sellTokens","tokenAmount","approve","undefined","content","event","currentForm","preventDefault","input","utils","toWei","output","width"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport Web3 from \"web3\";\nimport Token from \"./abis/waviii2.json\";\nimport EthSwap from \"./abis/WavSwap.json\";\nimport BuySell from \"./BuySell\";\nimport { WaveTopBottomLoading } from \"react-loadingg\";\nimport FadeIn from \"react-fade-in\";\nimport tokenLogo from \"../assets/img/token-logo.png\";\nimport ethLogo from \"../assets/img/eth-logo.png\";\nimport swapLogo from \"../assets/img/swap_logo.gif\";\nimport CountUp from \"react-countup\";\nimport {\n  Card,\n  CardHeader,\n  CardBody,\n  Row,\n  Col,\n} from \"reactstrap\";\n\nclass Swap extends Component {\n  async componentWillMount() {\n    await this.loadWeb3();\n    await this.loadBlockchainData();\n  }\n\n  async loadBlockchainData() {\n    if (this.state.loading) {\n      return false;\n    } else {\n      const web3 = window.web3;\n      const accounts = await web3.eth.getAccounts();\n      this.setState({ account: accounts[0] });\n      const ethBalance = await web3.eth.getBalance(this.state.account);\n      this.setState({ ethBalance });\n\n      // Load Token\n      const networkId = await web3.eth.net.getId();\n      const tokenData = Token.networks[networkId];\n      if (tokenData) {\n        const token = new web3.eth.Contract(Token.abi, tokenData.address);\n        this.setState({ token });\n        let tokenBalance = await token.methods\n          .balanceOf(this.state.account)\n          .call();\n        this.setState({ tokenBalance: tokenBalance.toString() });\n      } else {\n        window.alert(\"Token contract not deployed to detected network.\");\n        this.setState({ loading: true });\n      }\n\n      // Load EthSwap\n      const ethSwapData = EthSwap.networks[networkId];\n      if (ethSwapData) {\n        const ethSwap = new web3.eth.Contract(EthSwap.abi, ethSwapData.address);\n        this.setState({ ethSwap });\n      } else {\n        window.alert(\"EthSwap contract not deployed to detected network.\");\n        this.setState({ loading: true });\n      }\n\n      this.setState({ loading: false });\n    }\n  }\n\n  async loadWeb3() {\n    if (window.ethereum) {\n      window.web3 = new Web3(window.ethereum);\n      await window.ethereum.enable();\n    } else if (window.web3) {\n      window.web3 = new Web3(window.web3.currentProvider);\n    } else {\n      // window.alert('Non-Ethereum browser detected. You should consider trying MetaMask!')\n      this.setState({ loading: true });\n      this.setState({ noEth: true });\n    }\n  }\n\n  buyTokens = (etherAmount) => {\n    this.state.ethSwap.methods\n      .buyTokens()\n      .send({ value: etherAmount, from: this.state.account })\n      .on(\"transactionHash\", (hash) => {\n        this.setState({ loading: true });\n      })\n      .on(\"confirmation\", (reciept) => {\n        this.setState({ loading: false });\n        window.location.reload();\n      });\n  };\n\n  sellTokens = (tokenAmount) => {\n    this.state.token.methods\n      .approve(this.state.ethSwap.address, tokenAmount)\n      .send({ from: this.state.account })\n      .on(\"transactionHash\", (hash) => {\n        this.state.ethSwap.methods\n          .sellTokens(tokenAmount)\n          .send({ from: this.state.account })\n          .on(\"transactionHash\", (hash) => {\n            this.setState({ loading: true });\n          })\n          .on(\"confirmation\", (reciept) => {\n            this.setState({ loading: false });\n            window.location.reload();\n          });\n      });\n  };\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      account: \"\",\n      token: {},\n      ethSwap: {},\n      ethBalance: \"0\",\n      tokenBalance: \"0\",\n      loading: undefined,\n    };\n  }\n\n  render() {\n    let content;\n    if (this.state.loading) {\n      if (this.state.noEth) {\n        content = (\n          <FadeIn>\n            <FadeIn>\n              <CardBody className=\"waviii-2\">\n                <FadeIn>\n                  <div id=\"content\" className=\"mt-3\">\n                    <div className=\"d-flex justify-content-between mb-3\">\n                      <button\n                        className=\"btn btn-light waviii\"\n                        disabled\n                        onClick={(event) => {\n                          this.setState({ currentForm: \"buy\" });\n                        }}\n                      >\n                        Buy\n                      </button>\n                      <img src={swapLogo} className=\"swapLogo\" alt=\"waviii Swap Logo\" />\n                      <button\n                        className=\"btn btn-light waviii\"\n                        disabled\n                        onClick={(event) => {\n                          this.setState({ currentForm: \"sell\" });\n                        }}\n                      >\n                        Sell\n                      </button>\n                    </div>\n                    <br />\n\n                    <div className=\"card mb-4\">\n                      <div className=\"card-body\">\n                        <FadeIn>\n                          <form\n                            className=\"mb-3\"\n                            onSubmit={(event) => {\n                              event.preventDefault();\n                              let etherAmount;\n                              etherAmount = this.input.value.toString();\n                              etherAmount = window.web3.utils.toWei(\n                                etherAmount,\n                                \"Ether\"\n                              );\n                              this.props.buyTokens(etherAmount);\n                            }}\n                          >\n                            <div>\n                              <label className=\"float-left\">\n                                <b>Input</b>\n                              </label>\n                              <span className=\"float-right text-muted\">\n                                Balance:{\" \"}\n                                <CountUp\n                                  duration={2.7}\n                                  start={-10}\n                                  separator=\"\"\n                                  decimals={2}\n                                  decimal=\".\"\n                                  end={0}\n                                />\n                              </span>\n                            </div>\n                            <div className=\"input-group mb-4\">\n                              <input\n                                type=\"text\"\n                                onChange={(event) => {\n                                  const etherAmount = this.input.value.toString();\n                                  this.setState({\n                                    output: etherAmount * 100,\n                                  });\n                                }}\n                                ref={(input) => {\n                                  this.input = input;\n                                }}\n                                className=\"form-control form-control-lg\"\n                                placeholder=\"0\"\n                                disabled\n                              />\n                              <div className=\"input-group-append\">\n                                <div className=\"input-group-text\">\n                                  <strong>&nbsp;&nbsp;</strong>\n                                  <img src={ethLogo} height=\"29\" alt=\"\" />\n                                  <strong>&nbsp;&nbsp; ETH &nbsp;</strong>\n                                </div>\n                              </div>\n                            </div>\n                            <div>\n                              <label className=\"float-left\">\n                                <b>Output</b>\n                              </label>\n                              <span className=\"float-right text-muted\">\n                                Balance:{\" \"}\n                                <CountUp\n                                  duration={2.7}\n                                  start={-10}\n                                  separator=\"\"\n                                  decimals={2}\n                                  decimal=\".\"\n                                  end={0}\n                                />\n                              </span>\n                            </div>\n                            <div className=\"input-group mb-2\">\n                              <input\n                                type=\"text\"\n                                className=\"form-control form-control-lg\"\n                                placeholder=\"0\"\n                                value={this.state.output}\n                                disabled\n                              />\n                              <div className=\"input-group-append\">\n                                <div className=\"input-group-text waviii\">\n                                  <strong>&nbsp;&nbsp;</strong>\n                                  <img src={tokenLogo} height=\"29\" alt=\"\" />\n                                  <strong>&nbsp; waviii</strong>\n                                </div>\n                              </div>\n                            </div>\n                            <div className=\"mb-5\">\n                              <span className=\"float-left text-muted\">\n                                Exchange Rate\n                              </span>\n                              <span className=\"float-right text-muted waviii responsive3\">\n                                1 ETH = 100 waviii\n                              </span>\n                            </div>\n                            <button\n                              type=\"submit\"\n                              disabled\n                              className=\"btn btn-primary btn-block btn-lg waviii\"\n                            >\n                              locked\n                            </button>\n                          </form>\n                        </FadeIn>\n                      </div>\n                    </div>\n                    <br />\n                  <FadeIn>\n                    <a\n                      href=\"https://metamask.io/download.html\"\n                      className=\"noEth\"\n                    >\n                      <center>Blockchain browser not detected! Install MetaMask to use\n                      waviii.</center>\n                    </a>\n                  </FadeIn>\n                  </div>\n                </FadeIn>\n              </CardBody>\n            </FadeIn>\n          </FadeIn>\n        );\n      } else {\n        content = (\n          <p id=\"loader\" className=\"text-center\">\n            <WaveTopBottomLoading color={\"#2c91c7\"} />\n          </p>\n        );\n      }\n    } else {\n      content = (\n        <BuySell\n          ethBalance={this.state.ethBalance}\n          tokenBalance={this.state.tokenBalance}\n          buyTokens={this.buyTokens}\n          sellTokens={this.sellTokens}\n        />\n      );\n    }\n\n    return (\n      <>\n        <div className=\"content\">\n          <Row>\n            <Col md=\"12\">\n              <Card>\n                <FadeIn>\n                  <CardHeader className=\"responsive2\">\n                    <a\n                      className=\"waviii3 responsive2\"\n                      href={`https://etherscan.io/address/${this.state.account}`}\n                      target=\"_blank\"\n                      rel=\"noopener noreferrer\"\n                    >\n                      <span>{this.state.account}</span>\n                    </a>\n                  </CardHeader>\n                </FadeIn>\n                <CardBody className=\"all-icons\">\n                  <div\n                    className=\"content mr-auto ml-auto\"\n                    style={{ width: \"90%\" }}\n                  >\n                    {content}\n                  </div>\n                </CardBody>\n              </Card>\n            </Col>\n          </Row>\n        </div>\n      </>\n    );\n  }\n}\n\nexport default Swap;\n"]},"metadata":{},"sourceType":"module"}